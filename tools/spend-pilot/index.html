<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>SpendPilot - Smart Expense & Budget Tracker | Affilore Tools</title>
    <meta name="description" content="Free personal finance dashboard. Track expenses, visualize spending habits, and calculate the 'time cost' of your purchases. Privacy-first, no login required.">
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <link rel="icon" type="image/png" href="/logo.png">
    
    <script>
        tailwind.config = {
            darkMode: "class", 
            theme: {
                extend: {
                    colors: {
                        primary: "#FFBF00", 
                        "background-dark": "#121212", 
                        "card-dark": "#1A1A1A",
                        danger: "#FF4444",
                        success: "#00C851"
                    }, 
                    fontFamily: { outfit: ['Outfit', 'sans-serif'] }
                }
            }
        };
    </script>
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #121212; color: white; }
        .glass-header { background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .glass-card { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.05); }
    </style>
</head>
<body class="min-h-screen pt-24 pb-20">

<header class="fixed top-0 w-full z-50 glass-header px-6 py-4 text-white">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
        <div class="flex items-center gap-3">
            <a href="/" class="flex items-center gap-2 group">
                <span class="material-symbols-outlined text-slate-400 group-hover:text-primary transition-colors">arrow_back</span>
                <img src="/logo.png" alt="Affilore Logo" class="h-8 w-auto object-contain">
                <span class="text-xl font-bold">Affi<span class="text-primary">lore</span></span>
            </a>
            <div class="h-6 w-px bg-white/10 mx-2"></div>
            <h1 class="text-slate-400 text-sm font-medium">SpendPilot</h1>
        </div>
        <a href="/" class="hidden sm:block text-sm font-bold text-primary hover:text-white transition-colors">Back to Home</a>
    </div>
</header>

<main class="max-w-7xl mx-auto px-4 md:px-6">
    
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="lg:col-span-1 flex flex-col gap-6">
            
            <div class="glass-card rounded-2xl p-6 shadow-xl">
                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">add_circle</span> Add Transaction
                </h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Description</label>
                        <input type="text" id="desc" placeholder="e.g. Netflix, Grocery, Rent" class="w-full bg-black/50 border-white/10 rounded-lg text-white focus:border-primary focus:ring-primary">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Amount ($)</label>
                            <input type="number" id="amount" placeholder="0.00" class="w-full bg-black/50 border-white/10 rounded-lg text-white focus:border-primary focus:ring-primary">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase mb-1">Category</label>
                            <select id="category" class="w-full bg-black/50 border-white/10 rounded-lg text-white focus:border-primary focus:ring-primary">
                                <option value="Housing">Housing</option>
                                <option value="Food">Food</option>
                                <option value="Transport">Transport</option>
                                <option value="Entertainment">Entertainment</option>
                                <option value="Utilities">Utilities</option>
                                <option value="Shopping">Shopping</option>
                            </select>
                        </div>
                    </div>

                    <button onclick="addTransaction()" class="w-full py-3 bg-primary text-black font-bold rounded-lg hover:bg-yellow-400 transition-all shadow-lg shadow-primary/20">
                        ADD EXPENSE
                    </button>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-6 shadow-xl border-l-4 border-l-primary">
                <h3 class="text-lg font-bold text-white mb-2">ðŸ’° The "Real Cost"</h3>
                <p class="text-sm text-slate-400 mb-4">Enter your hourly wage to see how many hours of your life this expense costs.</p>
                
                <div class="flex gap-2 mb-4">
                    <input type="number" id="hourly-wage" placeholder="Hourly Wage ($)" class="w-full bg-black/50 border-white/10 rounded-lg text-white text-sm">
                </div>
                
                <div class="bg-white/5 rounded-lg p-4 text-center">
                    <span class="text-xs text-slate-400 uppercase tracking-widest">Life Energy Cost</span>
                    <div id="time-cost-display" class="text-2xl font-bold text-primary mt-1">0h 0m</div>
                </div>
            </div>

        </div>

        <div class="lg:col-span-2 flex flex-col gap-6">
            
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                <div class="glass-card p-5 rounded-xl">
                    <p class="text-slate-400 text-xs font-bold uppercase">Total Balance</p>
                    <p id="total-balance" class="text-3xl font-bold text-white mt-1">$0.00</p>
                </div>
                <div class="glass-card p-5 rounded-xl border-l-4 border-l-success">
                    <p class="text-slate-400 text-xs font-bold uppercase">Income</p>
                    <p id="total-income" class="text-2xl font-bold text-success mt-1">$0.00</p>
                </div>
                <div class="glass-card p-5 rounded-xl border-l-4 border-l-danger">
                    <p class="text-slate-400 text-xs font-bold uppercase">Expenses</p>
                    <p id="total-expense" class="text-2xl font-bold text-danger mt-1">$0.00</p>
                </div>
            </div>

            <div class="glass-card rounded-2xl p-6 h-[300px] relative">
                <canvas id="expenseChart"></canvas>
            </div>

            <div class="glass-card rounded-2xl p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-white">Recent Activity</h3>
                    <button onclick="clearData()" class="text-xs text-red-400 hover:text-red-300 font-bold uppercase">Reset Data</button>
                </div>
                <ul id="transaction-list" class="space-y-3 max-h-[300px] overflow-y-auto pr-2">
                    <li class="text-center text-slate-500 py-4 italic">No transactions yet. Start piloting your spending!</li>
                </ul>
            </div>

            <div class="glass-card rounded-2xl p-6 bg-gradient-to-br from-primary/10 to-transparent border border-primary/20">
                <div class="flex items-start gap-4">
                    <span class="material-symbols-outlined text-4xl text-primary">savings</span>
                    <div>
                        <h3 class="text-lg font-bold text-white">Compound Impact</h3>
                        <p class="text-sm text-slate-300 mt-1">
                            If you invested your total expenses (<span id="invest-amount" class="text-primary font-bold">$0</span>) 
                            instead of spending them, in 10 years at 7% return, you would have:
                        </p>
                        <p id="future-value" class="text-3xl font-bold text-white mt-2">$0.00</p>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="mt-12 max-w-4xl mx-auto text-slate-400 text-sm leading-relaxed text-center">
        <h2 class="text-xl font-bold text-white mb-2">Why SpendPilot?</h2>
        <p>Unlike other tools that require bank logins, SpendPilot is a <strong>privacy-first</strong> personal finance tracker. All data is stored locally on your device. We use unique "Time-Cost" analysis to help you understand the true value of your money by measuring it in hours worked, not just dollars spent.</p>
    </div>

</main>

<div id="cookie-banner" class="fixed bottom-0 left-0 w-full bg-[#1A1A1A] border-t border-glass-border shadow-2xl z-50 transform translate-y-full transition-transform duration-300">
    <div class="max-w-7xl mx-auto px-6 py-6 flex flex-col sm:flex-row items-center justify-between gap-6">
        <p class="text-sm text-gray-400">We store data locally in your browser. No servers, no spying.</p>
        <button id="accept-cookies" class="whitespace-nowrap rounded-full bg-primary px-8 py-3 text-sm font-bold text-charcoal transition hover:bg-white">Start Tracking</button>
    </div>
</div>

<script>
    // --- STATE MANAGEMENT ---
    let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
    
    // --- DOM ELEMENTS ---
    const balanceEl = document.getElementById('total-balance');
    const incomeEl = document.getElementById('total-income');
    const expenseEl = document.getElementById('total-expense');
    const listEl = document.getElementById('transaction-list');
    const amountInput = document.getElementById('amount');
    const descInput = document.getElementById('desc');
    const categoryInput = document.getElementById('category');
    const hourlyWageInput = document.getElementById('hourly-wage');
    const timeCostDisplay = document.getElementById('time-cost-display');
    const investAmountEl = document.getElementById('invest-amount');
    const futureValueEl = document.getElementById('future-value');
    
    // --- CHART SETUP ---
    let expenseChart;
    
    function initChart() {
        const ctx = document.getElementById('expenseChart').getContext('2d');
        expenseChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: [],
                datasets: [{
                    data: [],
                    backgroundColor: ['#FFBF00', '#FF4444', '#33b5e5', '#00C851', '#aa66cc', '#ffbb33'],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right', labels: { color: 'white', font: { family: 'Outfit' } } }
                }
            }
        });
    }

    // --- CORE FUNCTIONS ---
    function updateValues() {
        const amounts = transactions.map(t => t.amount);
        const total = amounts.reduce((acc, item) => (acc += item), 0).toFixed(2);
        const expense = (amounts.filter(item => item < 0).reduce((acc, item) => (acc += item), 0) * -1).toFixed(2);
        
        balanceEl.innerText = `$${total}`;
        expenseEl.innerText = `$${expense}`;
        
        // Future Impact Calc
        investAmountEl.innerText = `$${expense}`;
        const futureVal = (expense * Math.pow(1.07, 10)).toFixed(2);
        futureValueEl.innerText = `$${futureVal}`;

        updateChart();
        updateLocalStorage();
    }

    function addTransaction() {
        if(descInput.value.trim() === '' || amountInput.value.trim() === '') {
            alert('Please add a description and amount');
            return;
        }

        const transaction = {
            id: generateID(),
            desc: descInput.value,
            amount: -Math.abs(+amountInput.value), // Force negative for expenses
            category: categoryInput.value
        };

        transactions.push(transaction);
        addTransactionDOM(transaction);
        updateValues();
        
        descInput.value = '';
        amountInput.value = '';
    }

    function generateID() {
        return Math.floor(Math.random() * 100000000);
    }

    function addTransactionDOM(transaction) {
        const item = document.createElement('li');
        item.classList.add('glass-card', 'p-3', 'rounded-lg', 'flex', 'justify-between', 'items-center', 'group');
        item.innerHTML = `
            <div class="flex flex-col">
                <span class="font-bold text-white">${transaction.desc}</span>
                <span class="text-xs text-slate-500">${transaction.category}</span>
            </div>
            <div class="flex items-center gap-4">
                <span class="font-bold text-danger">-$${Math.abs(transaction.amount)}</span>
                <button onclick="removeTransaction(${transaction.id})" class="text-slate-600 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">
                    <span class="material-symbols-outlined text-lg">delete</span>
                </button>
            </div>
        `;
        listEl.prepend(item);
        
        // Remove empty state message if exists
        if(listEl.querySelector('li.italic')) {
            listEl.querySelector('li.italic').remove();
        }
    }

    function removeTransaction(id) {
        transactions = transactions.filter(t => t.id !== id);
        initList();
        updateValues();
    }

    function initList() {
        listEl.innerHTML = '';
        transactions.forEach(addTransactionDOM);
        if(transactions.length === 0) {
            listEl.innerHTML = '<li class="text-center text-slate-500 py-4 italic">No transactions yet. Start piloting your spending!</li>';
        }
    }

    function updateChart() {
        const categories = {};
        transactions.forEach(t => {
            categories[t.category] = (categories[t.category] || 0) + Math.abs(t.amount);
        });
        
        expenseChart.data.labels = Object.keys(categories);
        expenseChart.data.datasets[0].data = Object.values(categories);
        expenseChart.update();
    }

    function clearData() {
        if(confirm('Are you sure you want to clear all data? This cannot be undone.')) {
            transactions = [];
            initList();
            updateValues();
        }
    }

    function updateLocalStorage() {
        localStorage.setItem('transactions', JSON.stringify(transactions));
    }

    // --- TIME COST CALCULATOR LOGIC ---
    function calculateTimeCost() {
        const wage = parseFloat(hourlyWageInput.value);
        const price = parseFloat(amountInput.value);
        
        if (wage > 0 && price > 0) {
            const totalHours = price / wage;
            const hours = Math.floor(totalHours);
            const minutes = Math.round((totalHours - hours) * 60);
            timeCostDisplay.innerText = `${hours}h ${minutes}m`;
        } else {
            timeCostDisplay.innerText = "0h 0m";
        }
    }

    amountInput.addEventListener('input', calculateTimeCost);
    hourlyWageInput.addEventListener('input', () => {
        localStorage.setItem('hourlyWage', hourlyWageInput.value);
        calculateTimeCost();
    });

    // --- INIT ---
    initChart();
    initList();
    updateValues();
    
    // Load saved wage
    const savedWage = localStorage.getItem('hourlyWage');
    if(savedWage) hourlyWageInput.value = savedWage;

    // Cookie Banner
    if (!localStorage.getItem('affiloreCookieConsent')) {
        setTimeout(() => document.getElementById('cookie-banner').classList.remove('translate-y-full'), 1000);
    }
    document.getElementById('accept-cookies').addEventListener('click', () => {
        localStorage.setItem('affiloreCookieConsent', 'true');
        document.getElementById('cookie-banner').classList.add('translate-y-full');
    });

</script>
</body>
</html>
